<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Micro-credential Specification</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <header class="bg-blue-600 text-white py-4">
        <div class="container mx-auto px-4">
            <h1 class="text-2xl font-bold">Micro-credential Specification</h1>
            <p id="credential-title" class="text-lg"></p>
        </div>
    </header>

    <nav class="bg-gray-800 text-white py-2">
        <div class="container mx-auto px-4 flex space-x-4">
            <a href="#overview" class="hover:underline">Overview</a>
            <a href="#learning-outcomes" class="hover:underline">Learning Outcomes</a>
            <a href="#assessment" class="hover:underline">Assessment Criteria</a>
            <a href="#delivery" class="hover:underline">Delivery Methods</a>
            <a href="#resources" class="hover:underline">Resources</a>
            <a href="#evaluation" class="hover:underline">Evaluation Form</a>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8">
        <section id="overview" class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Overview</h2>
            <div id="overview-content" class="bg-white p-4 rounded shadow"></div>
        </section>

        <section id="learning-outcomes" class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Learning Outcomes</h2>
            <div id="learning-outcomes-content" class="bg-white p-4 rounded shadow"></div>
        </section>

        <section id="assessment" class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Assessment Criteria</h2>
            <div id="assessment-content" class="bg-white p-4 rounded shadow"></div>
        </section>

        <section id="delivery" class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Delivery Methods</h2>
            <div id="delivery-content" class="bg-white p-4 rounded shadow"></div>
        </section>

        <section id="resources" class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Resources</h2>
            <div id="resources-content" class="bg-white p-4 rounded shadow"></div>
        </section>

        <section id="evaluation" class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Evaluation Form</h2>
            <p class="mb-4">Please provide your feedback to help us improve this micro-credential.</p>
            <iframe src="https://docs.google.com/forms/d/e/your-form-id/viewform?embedded=true" width="100%" height="800" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>
            <p class="mt-4 text-sm">All responses are anonymous unless you choose to provide contact information. The data collected will only be used for quality improvement purposes.</p>
        </section>
    </main>

    <footer class="bg-gray-800 text-white py-4">
        <div class="container mx-auto px-4">
            <p>Telematic Engineering Department</p>
            <p>Universidad Carlos III de Madrid</p>
            <p><a href="mailto:info@uc3m.es" class="underline">info@uc3m.es</a></p>
            <p>&copy; 2025 UC3M</p>
        </div>
    </footer>

    <script>
        // Function to get query parameter by name
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Function to fetch and render JSON data
        async function loadSpecification() {
            const id = getQueryParam('id');
            if (!id) {
                document.getElementById('overview-content').innerHTML = '<p class="text-red-500">Error: No specification ID provided.</p>';
                return;
            }

            try {
                const response = await fetch(`/specifications/${id}.json`);
                if (!response.ok) throw new Error('Specification not found');
                const data = await response.json();

                // Update page title
                document.getElementById('credential-title').textContent = data.name;

                // Render Overview
                document.getElementById('overview-content').innerHTML = `
                    <p><strong>Issuing University:</strong> ${data.issuing_university}</p>
                    <p><strong>Department:</strong> ${data.entity}</p>
                    <p><strong>Language:</strong> ${data.language}</p>
                    <p><strong>Duration:</strong> ${data.start_date} - ${data.end_date}</p>
                    <p><strong>Level:</strong> ${data.level_of_experience}</p>
                    <p><strong>Prerequisites:</strong></p>
                    <ul class="list-disc pl-5">${data.admission_requirements.map(req => `<li>${req}</li>`).join('')}</ul>
                `;

                // Render Learning Outcomes
                document.getElementById('learning-outcomes-content').innerHTML = `
                    <p>Upon successful completion, learners will be able to:</p>
                    <ul class="list-disc pl-5">${data.learning_outcomes.map(outcome => `<li>${outcome}</li>`).join('')}</ul>
                    <p><strong>Competency Frameworks:</strong> ${data.competency_frameworks.join(', ')}</p>
                `;

                // Render Assessment Criteria
                document.getElementById('assessment-content').innerHTML = `
                    <p><strong>Assessment Methods:</strong></p>
                    <ul class="list-disc pl-5">
                        ${Object.entries(data.assessment_methods).map(([method, weight]) => `<li>${method}: ${weight}</li>`).join('')}
                    </ul>
                    <p><strong>Trainers:</strong></p>
                    <ul class="list-disc pl-5">${data.trainers.map(trainer => `<li>${trainer}</li>`).join('')}</ul>
                    <p><strong>Stackability:</strong> ${data.stackability_options}</p>
                `;

                // Render Delivery Methods
                document.getElementById('delivery-content').innerHTML = `
                    <p><strong>Mode of Instruction:</strong> ${data.mode_of_instruction}</p>
                    <p><strong>Learning Activities:</strong></p>
                    <ul class="list-disc pl-5">${data.learning_activities.map(activity => `<li>${activity}</li>`).join('')}</ul>
                    <p><strong>Workload:</strong> Theoretical: ${data.workload_theoretical} hours, Practical: ${data.workload_practical} hours</p>
                `;

                // Render Resources (Content Description)
                document.getElementById('resources-content').innerHTML = `
                    <p><strong>Modules:</strong></p>
                    ${data.content_description.map(module => `
                        <div class="mb-4">
                            <h3 class="text-lg font-semibold">${module.module} (${module.hours} hours)</h3>
                            ${module.sub_modules.map(sub => `
                                <div class="ml-4">
                                    <p><strong>${sub.name}</strong> (${sub.hours} hours)</p>
                                    <p><strong>Time Allocation:</strong> ${sub.time_allocation}</p>
                                    <p><strong>Learning Activity:</strong> ${sub.learning_activity}</p>
                                </div>
                            `).join('')}
                        </div>
                    `).join('')}
                `;
            } catch (error) {
                document.getElementById('overview-content').innerHTML = `<p class="text-red-500">Error loading specification: ${error.message}</p>`;
            }
        }

        // Load specification when the page loads
        window.onload = loadSpecification;
    </script>
</body>
</html>